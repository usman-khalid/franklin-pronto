import{j as f,k as g}from"./block-utils.min.js";function o(e,s={}){o.defer=o.defer||[];const d=n=>{o[n]=o[n]||((...t)=>o.defer.push({fnname:n,args:t}))};o.drain=o.drain||((n,t)=>{o[n]=t,o.defer.filter(({fnname:i})=>n===i).forEach(({fnname:i,args:r})=>o[i](...r))}),o.on=(n,t)=>{o.cases[n]=t},d("observe"),d("cwv");try{if(window.hlx=window.hlx||{},!window.hlx.rum){const r=new URLSearchParams(window.location.search).get("rum")==="on"?1:100,a=`${(m=>m.split("").reduce((w,p)=>(w<<5)-w+p.charCodeAt(0)|0,0))(window.location.href)}-${new Date().getTime()}-${Math.random().toString(16).substr(2,14)}`,l=Math.random(),h=l*r<1,u={full:()=>window.location.href,origin:()=>window.location.origin,path:()=>window.location.href.replace(/\?.*$/,"")};window.hlx.rum={weight:r,id:a,random:l,isSelected:h,sampleRUM:o,sanitizeURL:u[window.hlx.RUM_MASK_URL||"path"]}}const{weight:n,id:t}=window.hlx.rum;if(window.hlx&&window.hlx.rum&&window.hlx.rum.isSelected){const i=(r=s)=>{const c=JSON.stringify({weight:n,id:t,referer:window.hlx.rum.sanitizeURL(),checkpoint:e,...s}),a=`https://rum.hlx.page/.rum/${n}`;navigator.sendBeacon(a,c),console.debug(`ping:${e}`,r)};o.cases=o.cases||{cwv:()=>o.cwv(s)||!0,lazy:()=>{const r=document.createElement("script");return r.src="https://rum.hlx.page/.rum/@adobe/helix-rum-enhancer@^1/src/index.js",document.head.appendChild(r),!0}},i(s),o.cases[e]&&o.cases[e]()}}catch{}}async function $(e="default"){return window.placeholders=window.placeholders||{},window.placeholders[`${e}-loaded`]||(window.placeholders[`${e}-loaded`]=new Promise((d,n)=>{fetch(`${e==="default"?"":e}/placeholders.json`).then(t=>{if(t.ok)return t.json();throw new Error(`${t.status}: ${t.statusText}`)}).then(t=>{const i={};t.data.filter(r=>r.Key).forEach(r=>{i[f(r.Key)]=r.Text}),window.placeholders[e]=i,d()}).catch(t=>{window.placeholders[e]={},n(t)})})),await window.placeholders[`${e}-loaded`],window.placeholders[e]}async function b(e){const s=document.querySelector(".block");s&&e.includes(s.dataset.blockName)&&await g(s),document.body.style.display=null;const n=document.querySelector("main img");await new Promise(t=>{n&&!n.complete?(n.setAttribute("loading","eager"),n.addEventListener("load",t),n.addEventListener("error",t)):t()})}function x(){window.hlx=window.hlx||{},window.hlx.RUM_MASK_URL="full",window.hlx.codeBasePath="",window.hlx.lighthouse=new URLSearchParams(window.location.search).get("lighthouse")==="on";const e=document.querySelector('script[src$="/dist/lib/scripts.min.js"]');if(e)try{[window.hlx.codeBasePath]=new URL(e.src).pathname.split("/dist/lib/scripts.min.js")}catch(s){console.log(s)}}function L(){x(),o("top"),window.addEventListener("load",()=>o("load")),window.addEventListener("unhandledrejection",e=>{o("error",{source:e.reason.sourceURL,target:e.reason.line})}),window.addEventListener("error",e=>{o("error",{source:e.filename,target:e.lineno})})}L();export{$ as fetchPlaceholders,o as sampleRUM,x as setup,b as waitForLCP};
